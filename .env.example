# ===========================================
# Database Configuration (PostgreSQL推奨)
# ===========================================
# DATABASE_TYPE determines the storage backend:
# - postgres: PostgreSQL（本番運用推奨）- Supabase, Neon, AWS RDS等
# - kv: Vercel KV（開発・小規模テスト用）- 無料枠で保存数制限あり
# - sqlite: Local SQLite（ローカル開発用）
DATABASE_TYPE=postgres

# PostgreSQL接続（DATABASE_TYPE=postgresの場合）
DATABASE_URL=postgresql://user:password@localhost:5432/llm_trace_lens

# ===========================================
# Vercel KV（DATABASE_TYPE=kvの場合、開発・小規模テスト用）
# ===========================================
# Create a KV store in Vercel Dashboard and copy the credentials here
KV_REST_API_URL=https://your-kv-instance.kv.vercel-storage.com
KV_REST_API_TOKEN=your-kv-token

# ===========================================
# トレース保持ポリシー（KV使用時）
# ===========================================
# KVストレージの容量制限を管理します
MAX_TRACES=5000          # ワークスペースあたりの最大トレース数
MAX_AGE_DAYS=30          # トレース保存期間（日数）

# ===========================================
# Server Configuration
# ===========================================
PORT=3000
NODE_ENV=development
LOG_LEVEL=info
MAX_RETRIES=3
TIMEOUT_MS=30000

# ===========================================
# Local Development Only - API Keys
# ===========================================
# For SaaS deployment, API keys are managed via /setup UI (stored in Vercel KV)
# For local development without KV, you can set keys here:
OPENAI_API_KEY=sk-your-api-key-here
ANTHROPIC_API_KEY=your_anthropic_api_key_here
GOOGLE_API_KEY=your_google_api_key_here
DEEPSEEK_API_KEY=your_deepseek_api_key_here

# ===========================================
# Authentication (optional)
# ===========================================
ENABLE_AUTH=false
API_KEYS=your-secret-key-1,your-secret-key-2

# ===========================================
# Admin API (for threshold management)
# ===========================================
# Admin API Key for debug endpoints (validation config management)
# Required for /admin/* endpoints
ADMIN_API_KEY=your-secure-admin-key-here

# ===========================================
# OAuth/SSO Configuration
# ===========================================
# Google OAuth (for Dashboard SSO)
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret

# Microsoft Entra ID (Azure AD)
# Get these from Azure Portal > Azure Active Directory > App registrations
AZURE_AD_CLIENT_ID=your_azure_client_id
AZURE_AD_CLIENT_SECRET=your_azure_client_secret
AZURE_AD_TENANT_ID=your_tenant_id  # Use 'common' for multi-tenant

# ===========================================
# PostgreSQL Configuration (if DATABASE_TYPE=postgres)
# ===========================================
# 本番運用では PostgreSQL を強く推奨します
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_password
POSTGRES_DB=llm_trace_lens

# Supabase/Neon PostgreSQL（接続文字列を使用）
# POSTGRES_URL=postgresql://postgres:password@db.xxxx.supabase.co:5432/postgres

# ===========================================
# SQLite Configuration (ローカル開発用)
# ===========================================
DB_TYPE=sqlite  # Options: sqlite, postgres
SQLITE_PATH=./data/traces.db

# ===========================================
# Webhook Configuration
# ===========================================
WEBHOOK_ENABLED=false
WEBHOOK_URL=https://your-webhook-endpoint.com/notify
WEBHOOK_EVENTS=BLOCK,WARN,COST_ALERT
WEBHOOK_TIMEOUT_MS=5000
WEBHOOK_MAX_RETRIES=3

# ===========================================
# Budget Configuration
# ===========================================
# MONTHLY_BUDGET=100
# BUDGET_ALERT_THRESHOLDS=0.8,0.95

# ===========================================
# Rate Limiting
# ===========================================
RATE_LIMIT_ENABLED=false
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=60000

# ===========================================
# Email / SMTP Configuration (for reports)
# ===========================================
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=user@example.com
SMTP_PASS=your_password
SMTP_FROM=reports@llm-trace-lens.com
